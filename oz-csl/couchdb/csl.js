{
  "_id": "_design/csl",
  "_rev": "19-6d59a341efd601f698870c3afac570b4",
  "lists": {
    "triples": "function(head,req) { var row; start({ 'headers': { 'Content-Type': 'text/plain' } }); while(row = getRow()) { send(row.value); } }"
  },
  "views": {
    "doi-orcid": {
      "map": "function (doc) {\n  if (doc['message-format']) {\n    if (doc['message-format'] == 'application/vnd.crossref-api-message+json') {\n     // citations\n     for (var i in doc.message.author) {\n       if (doc.message.author[i].ORCID) {\n         var name = '';\n         if (doc.message.author[i].literal) {\n           name = doc.message.author[i].literal;\n         } else {\n           name = doc.message.author[i].given + ' ' + doc.message.author[i].family;\n         }\n          emit(doc.message.DOI, [doc.message.author[i].ORCID.replace(/https?:\\/\\/orcid.org\\//, ''), name, (parseInt(i)+1)]);\n       }    \n     }\n    }\n    \n  if (doc['message-format'] == 'application/vnd.citationstyles.csl+json') {\n    if (doc.message.DOI) {\n      for (var i in doc.message.author) {\n        if (doc.message.author[i].ORCID) {\n          // ignore cases where author is actually all the authors\n          var go = true;\n          if (doc.message.author[i].literal.match(/ and /)) {\n            go = false;\n          }\n          if (go) {\n            emit(doc.message.DOI.toLowerCase(), [doc.message.author[i].ORCID, doc.message.author[i].literal, parseInt(i)+1]);\n          }\n        }\n      }\n    }\n  }    \n    \n  }\n}"
    },
    "nt": {
      "map": "/*\n\nShared code\n\n\n*/\n//----------------------------------------------------------------------------------------\n// http://stackoverflow.com/a/25715455\nfunction isObject(item) {\n  return (typeof item === \"object\" && !Array.isArray(item) && item !== null);\n}\n\n//----------------------------------------------------------------------------------------\n// http://stackoverflow.com/a/21445415\nfunction uniques(arr) {\n  var a = [];\n  for (var i = 0, l = arr.length; i < l; i++)\n    if (a.indexOf(arr[i]) === -1 && arr[i] !== '')\n      a.push(arr[i]);\n  return a;\n}\n\n\n//----------------------------------------------------------------------------------------\n// Store a triple with optional language code\nfunction triple(subject, predicate, object, language) {\n  var triple = [];\n  triple[0] = subject;\n  triple[1] = predicate;\n  triple[2] = object;\n\n  if (typeof language === 'undefined') {} else {\n    triple[3] = language;\n  }\n\n  return triple;\n}\n\n//----------------------------------------------------------------------------------------\n// Enclose triple in suitable wrapping for HTML display or triplet output\nfunction wrap(s, html) {\n  if (s) {\n\n    if (s.match(/^(http|urn|_:)/)) {\n      s = s.replace(/\\\\_/g, '_');\n\n      // handle < > in URIs such as SICI-based DOIs\n      s = s.replace(/</g, '%3C');\n      s = s.replace(/>/g, '%3E');\n\n      if (html) {\n        s = '&lt;' + s + '&gt;';\n      } else {\n        s = '<' + s + '>';\n      }\n    } else {\n      s = '\"' + s.replace(/\"/g, '\\\\\"') + '\"';\n    }\n  }\n  return s;\n}\n\n//----------------------------------------------------------------------------------------\n// https://css-tricks.com/snippets/javascript/htmlentities-for-javascript/\nfunction htmlEntities(str) {\n  return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\n\n//----------------------------------------------------------------------------------------\nfunction detect_language(s) {\n  var language = null;\n  var matched = 0;\n  var parts = [];\n\n  var regexp = [];\n\n  // https://gist.github.com/ryanmcgrath/982242\n  regexp['ja'] = /[\\u3000-\\u303F]|[\\u3040-\\u309F]|[\\u30A0-\\u30FF]|[\\uFF00-\\uFFEF]|[\\u4E00-\\u9FAF]|[\\u2605-\\u2606]|[\\u2190-\\u2195]|\\u203B/g;\n  // http://hjzhao.blogspot.co.uk/2015/09/javascript-detect-chinese-character.html\n  regexp['zh'] = /[\\u4E00-\\uFA29]/g;\n  // http://stackoverflow.com/questions/32709687/js-check-if-string-contains-only-cyrillic-symbols-and-spaces\n  regexp['ru'] = /[\\u0400-\\u04FF]/g;\n\n  for (var i in regexp) {\n    parts = s.match(regexp[i]);\n\n    if (parts != null) {\n      if (parts.length > matched) {\n        language = i;\n        matched = parts.length;\n      }\n    }\n  }\n\n  // require a minimum matching\n  if (matched < 2) {\n    language = null;\n  }\n\n  return language;\n\n}\n\n//----------------------------------------------------------------------------------------\nfunction finger_print(s) {\n\ts = s.toLowerCase();\n\n\t// stop words\n\t// en\n\ts = s.replace(/\\bfor\\b/g, '');\n\ts = s.replace(/\\band\\b/g, '')\n\ts = s.replace(/\\bof\\b/g, '');\n\ts = s.replace(/\\bthe\\b/g, '');\n\ts = s.replace(/\\bin\\b/g, '');\n\n\t// fr\n\ts = s.replace(/\\bde\\b/g, '');\n\ts = s.replace(/\\bla\\b/g, '');\n\ts = s.replace(/\\bet\\b/g, '');\n\n\t// de\n\ts = s.replace(/\\bdas\\b/g, '');\n\ts = s.replace(/\\bder\\b/g, '');\n\ts = s.replace(/\\bfur\\b/g, '');\n\n\t// numbers\n\ts = s.replace(/\\d+/g, '');\n\n\n\t// white space\n\ts = s.replace(/\\s\\s*/g, '');\n\n\t// punctuation\n\ts = s.replace(/[\\.|,|\\'|\\(|\\)|\"|:|-|&|-]+/g, '');\n\n\treturn s;\n}\n\n//----------------------------------------------------------------------------------------\nfunction output(doc, triples) {\n  // CouchDB\n  for (var i in triples) {\n    var s = 0;\n    var p = 1;\n    var o = 2;\n\n    var lang = 3;\n\n    var nquads = wrap(triples[i][s], false) +\n      ' ' + wrap(triples[i][p], false) +\n      ' ' + wrap(triples[i][o], false);\n    if (triples[i][lang]) {\n      nquads += '@' + triples[i][lang];\n    }\n\n    nquads += ' .' + \"\\n\";\n\n    // use cluster_id as the key so triples from different versions are linked together\n    emit(doc._id, nquads);\n    //console.log(nquads);\n  }\n}\n\nvar issn_lookup = {\n    \"actaamazonica\": [\n        \"0044-5967\"\n    ],\n    \"actabiolparan\": [\n        \"0301-2123\"\n    ],\n    \"actabotacadscihung\": [\n        \"0001-5350\"\n    ],\n    \"actabotanicabrasilica\": [\n        \"0102-3306\"\n    ],\n    \"actabotanicaneerlandica\": [\n        \"0044-5983\"\n    ],\n    \"actabotborealoccidsin\": [\n        \"1000-4025\"\n    ],\n    \"actabotbrasil\": [\n        \"0102-3306\"\n    ],\n    \"actabotcroat\": [\n        \"0365-0588\"\n    ],\n    \"actabotgallica\": [\n        \"1253-8078\"\n    ],\n    \"actabotgallicabotlett\": [\n        \"1253-8078\"\n    ],\n    \"actabothung\": [\n        \"0236-6495\"\n    ],\n    \"actabotmalac\": [\n        \"0210-9506\"\n    ],\n    \"actabotmex\": [\n        \"0187-7151\"\n    ],\n    \"actabotneerl\": [\n        \"0044-5983\"\n    ],\n    \"actabotvenez\": [\n        \"0084-5906\"\n    ],\n    \"actabotyunnan\": [\n        \"0253-2700\"\n    ],\n    \"actahortiberg\": [\n        \"0373-4269\"\n    ],\n    \"actamanilana\": [\n        \"0065-1370\"\n    ],\n    \"actaphytotaxgeobot\": [\n        \"0001-6799\",\n        \"1346-7565\"\n    ],\n    \"actaphytotaxsin\": [\n        \"0529-1526\"\n    ],\n    \"actasocbotpoloniae\": [\n        \"0001-6977\"\n    ],\n    \"actualbiol\": [\n        \"0304-3584\"\n    ],\n    \"adansonia\": [\n        \"1280-8571\",\n        \"0001-804X\",\n        \"1954-6475\"\n    ],\n    \"adansoniaser\": [\n        \"0001-804X\"\n    ],\n    \"adansoniasér\": [\n        \"0001-804X\"\n    ],\n    \"africanjbiotech\": [\n        \"1684-5315\"\n    ],\n    \"aliso\": [\n        \"2327-2929\"\n    ],\n    \"allertonia\": [\n        \"0735-8032\"\n    ],\n    \"alpinebot\": [\n        \"1664-2201\"\n    ],\n    \"amerfernj\": [\n        \"0002-8444\"\n    ],\n    \"americanfernjournal\": [\n        \"0002-8444\"\n    ],\n    \"americanjournalbotany\": [\n        \"0002-9122\"\n    ],\n    \"amerjbot\": [\n        \"0002-9122\"\n    ],\n    \"amermidlnaturalist\": [\n        \"0003-0031\"\n    ],\n    \"amerorchidsocbull\": [\n        \"0003-0252\"\n    ],\n    \"analesdeljardínbotánicomadrid\": [\n        \"0211-1322\"\n    ],\n    \"analesinstbiolunivnacautónméxicobot\": [\n        \"0185-254X\"\n    ],\n    \"analesjardbotmadrid\": [\n        \"0211-1322\"\n    ],\n    \"annalesbotanicifennici\": [\n        \"0003-3847\"\n    ],\n    \"annbotfenn\": [\n        \"0003-3847\"\n    ],\n    \"annbotoxford\": [\n        \"0305-7364\"\n    ],\n    \"annbotrome\": [\n        \"0365-0812\"\n    ],\n    \"anncarnegiemus\": [\n        \"0097-4463\"\n    ],\n    \"annjardbotbuitenzorg\": [\n        \"0169-5754\"\n    ],\n    \"annmagnathist\": [\n        \"0374-5481\"\n    ],\n    \"annmissouribotgard\": [\n        \"0026-6493\"\n    ],\n    \"annmuscolmarseille\": [\n        \"1256-4060\"\n    ],\n    \"annnathist\": [\n        \"0374-5481\"\n    ],\n    \"annnaturhistmuswien\": [\n        \"0083-6133\",\n        \"0255-0105\"\n    ],\n    \"annnaturhistmuswienb\": [\n        \"0255-0105\"\n    ],\n    \"annnewyorkacadsci\": [\n        \"0077-8923\"\n    ],\n    \"annscinatbot\": [\n        \"0150-9314\"\n    ],\n    \"anntransvaalmus\": [\n        \"0041-1752\"\n    ],\n    \"anntsukubabotgard\": [\n        \"0289-3568\"\n    ],\n    \"annuaireconservjardbotgenève\": [\n        \"0255-9676\"\n    ],\n    \"aquaticbot\": [\n        \"0304-3770\"\n    ],\n    \"archivmusnacriojaneiro\": [\n        \"0365-4508\"\n    ],\n    \"archjardbotriojaneiro\": [\n        \"0103-2550\"\n    ],\n    \"archmusnacriojaneiro\": [\n        \"0365-4508\"\n    ],\n    \"arcula\": [\n        \"0946-9575\"\n    ],\n    \"arkbot\": [\n        \"0376-1649\"\n    ],\n    \"arkivbotstockh\": [\n        \"0376-1649\"\n    ],\n    \"arnaldoa\": [\n        \"1815-8242\"\n    ],\n    \"aroideana\": [\n        \"0197-4033\"\n    ],\n    \"arqmusnacriojaneiro\": [\n        \"0365-4508\"\n    ],\n    \"asklepios\": [\n        \"0260-9533\"\n    ],\n    \"australianjournalbotany\": [\n        \"0067-1924\"\n    ],\n    \"australiansystematicbotany\": [\n        \"1030-1887\"\n    ],\n    \"australjbot\": [\n        \"0067-1924\"\n    ],\n    \"australjbotsupplser\": [\n        \"0810-6908\"\n    ],\n    \"australorchidrev\": [\n        \"0045-0782\"\n    ],\n    \"australsystbot\": [\n        \"1030-1887\",\n        \"0067-1924\"\n    ],\n    \"austrobaileya\": [\n        \"0155-4131\"\n    ],\n    \"balduinia\": [\n        \"1808-2688\"\n    ],\n    \"bangladeshjpltaxon\": [\n        \"1028-2092\"\n    ],\n    \"bauhinia\": [\n        \"0067-4605\"\n    ],\n    \"beitrbiolpflanzen\": [\n        \"0005-8041\"\n    ],\n    \"belgjbot\": [\n        \"0778-4031\"\n    ],\n    \"berdeutschbotges\": [\n        \"0011-9970\"\n    ],\n    \"berschweizbotges\": [\n        \"0366-3094\"\n    ],\n    \"biodiversdataj\": [\n        \"1314-2828\"\n    ],\n    \"biodiversresconservation\": [\n        \"1897-2810\"\n    ],\n    \"bioldiversityconservation\": [\n        \"1308-8084\"\n    ],\n    \"bishopmusbullbot\": [\n        \"0893-3138\"\n    ],\n    \"blumea\": [\n        \"0006-5196\"\n    ],\n    \"blumeabiodiversityevolutionbiogeographyplants\": [\n        \"0006-5196\"\n    ],\n    \"blumeasuppl\": [\n        \"0373-4293\"\n    ],\n    \"boissiera\": [\n        \"0373-2975\"\n    ],\n    \"bolbotunivsaopaulo\": [\n        \"0302-2439\"\n    ],\n    \"boletimbotânica\": [\n        \"0302-2439\"\n    ],\n    \"bolinstbotunivguadalajara\": [\n        \"0187-7054\"\n    ],\n    \"bolmusgoeldihistnatethnogr\": [\n        \"0100-4123\"\n    ],\n    \"bolmushistnattucuman\": [\n        \"1669-4309\"\n    ],\n    \"bolmusparaenseemiliogoeldinsbot\": [\n        \"0077-2216\"\n    ],\n    \"bolsocbotméx\": [\n        \"0366-2128\"\n    ],\n    \"bolsocbotméxico\": [\n        \"0366-2128\"\n    ],\n    \"bonplandiacorrientes\": [\n        \"0524-0476\"\n    ],\n    \"bostonjnathist\": [\n        \"0271-5716\"\n    ],\n    \"botanicaljournallinneansociety\": [\n        \"0024-4074\"\n    ],\n    \"botanicalmagazinetokyo\": [\n        \"0006-808X\"\n    ],\n    \"botbullacadsin\": [\n        \"0006-8063\"\n    ],\n    \"botbullacadsintaipei\": [\n        \"0006-8063\"\n    ],\n    \"botgaz\": [\n        \"0006-8071\"\n    ],\n    \"bothalia\": [\n        \"0006-8241\"\n    ],\n    \"bothelv\": [\n        \"0253-1453\"\n    ],\n    \"botjahrbsyst\": [\n        \"0006-8152\"\n    ],\n    \"botjlinnsoc\": [\n        \"0024-4074\"\n    ],\n    \"botmag\": [\n        \"1355-4905\"\n    ],\n    \"botmagkewmag\": [\n        \"1355-4905\"\n    ],\n    \"botmagtokyo\": [\n        \"0006-808X\"\n    ],\n    \"botmusleafl\": [\n        \"0006-8098\"\n    ],\n    \"botnot\": [\n        \"0006-8195\"\n    ],\n    \"botrevlancaster\": [\n        \"0006-8101\"\n    ],\n    \"botsci\": [\n        \"2007-4298\"\n    ],\n    \"botstudtaipei\": [\n        \"1817-406X\",\n        \"1999-3110\"\n    ],\n    \"bottidsskr\": [\n        \"0006-8187\"\n    ],\n    \"botzhurnmoscowleningrad\": [\n        \"0006-8136\"\n    ],\n    \"bouteloua\": [\n        \"1988-4257\"\n    ],\n    \"bradea\": [\n        \"0084-800X\"\n    ],\n    \"bradleya\": [\n        \"0265-086X\"\n    ],\n    \"britferngaz\": [\n        \"0524-5826\"\n    ],\n    \"brittonia\": [\n        \"0007-196X\"\n    ],\n    \"brunonia\": [\n        \"0313-4245\"\n    ],\n    \"bullbimenssoclinnlyon\": [\n        \"0366-1326\"\n    ],\n    \"bullbotresharbin\": [\n        \"1673-5102\"\n    ],\n    \"bullbotsurvindia\": [\n        \"0006-8128\"\n    ],\n    \"bullbritmusnathistbot\": [\n        \"0068-2292\"\n    ],\n    \"bulletinmiscellaneousinformationkewadditionalseriesnewgeneraspeciescyperaceae\": [\n        \"0366-4457\"\n    ],\n    \"bulletinmiscellaneousinformationroyalgardenskew\": [\n        \"0366-4457\"\n    ],\n    \"bulletinsoci?t?botaniquefrance\": [\n        \"0037-8941\"\n    ],\n    \"bullherbboissier\": [\n        \"0256-5617\"\n    ],\n    \"bulljardbotbuitenzorg\": [\n        \"0852-8756\"\n    ],\n    \"bulljardbotnatlbelg\": [\n        \"0303-9153\",\n        \"0374-6313\",\n        \"0037-9557\"\n    ],\n    \"bulljardbotétatbruxelles\": [\n        \"0374-6313\"\n    ],\n    \"bullmenssoclinnlyon\": [\n        \"0366-1326\"\n    ],\n    \"bullmenssoclinnparis\": [\n        \"1954-6483\"\n    ],\n    \"bullmiscinformkew\": [\n        \"0366-4457\"\n    ],\n    \"bullmiscinformkewadditser\": [\n        \"0366-4457\"\n    ],\n    \"bullmushistnatparis\": [\n        \"1148-8425\",\n        \"0240-8937\"\n    ],\n    \"bullmusnationhistnatparis\": [\n        \"0376-4443\"\n    ],\n    \"bullmusnatlhistnat\": [\n        \"1148-8425\",\n        \"0240-8937\"\n    ],\n    \"bullmusnatlhistnatbadansonia\": [\n        \"0240-8937\"\n    ],\n    \"bullnathistmuslondonbot\": [\n        \"0968-0446\"\n    ],\n    \"bullnatlmusnatscitokyob\": [\n        \"1881-9060\"\n    ],\n    \"bullnewyorkbotgard\": [\n        \"8755-4801\"\n    ],\n    \"bullsocbotfrance\": [\n        \"0037-8941\"\n    ],\n    \"bullsocbotfrancelettbot\": [\n        \"0181-1797\",\n        \"0037-8941\"\n    ],\n    \"bullsoclinnparis\": [\n        \"1954-6483\"\n    ],\n    \"bullsocneuchâteloisescinat\": [\n        \"0366-3469\"\n    ],\n    \"bullsocroybotbelgique\": [\n        \"0037-9557\"\n    ],\n    \"bulltorreybotclub\": [\n        \"0040-9618\"\n    ],\n    \"bunrui\": [\n        \"1346-6852\"\n    ],\n    \"butinstcatalanahistnat\": [\n        \"0210-6205\",\n        \"1133-6889\"\n    ],\n    \"cactsuccjlosangeles\": [\n        \"0007-9367\"\n    ],\n    \"cactsucmex\": [\n        \"0526-717X\"\n    ],\n    \"caldasia\": [\n        \"0366-5232\"\n    ],\n    \"canadjbot\": [\n        \"0008-4026\"\n    ],\n    \"candollea\": [\n        \"0373-2967\"\n    ],\n    \"carnifloraaustralis\": [\n        \"1448-9570\"\n    ],\n    \"carnivplnewslett\": [\n        \"0190-9215\"\n    ],\n    \"castanea\": [\n        \"0008-7475\"\n    ],\n    \"ceiba\": [\n        \"0008-8692\"\n    ],\n    \"cienciamexico\": [\n        \"1405-6550\"\n    ],\n    \"cladistics\": [\n        \"0748-3007\"\n    ],\n    \"collectaneabotanica\": [\n        \"0010-0730\"\n    ],\n    \"collectbotbarcelona\": [\n        \"0010-0730\"\n    ],\n    \"contrbiollabkyotouniv\": [\n        \"0452-9987\"\n    ],\n    \"contrgrayherb\": [\n        \"0195-6094\"\n    ],\n    \"contribherbaustral\": [\n        \"1030-1887\"\n    ],\n    \"contribqueenslherb\": [\n        \"2202-0802\"\n    ],\n    \"contributionsfromherbariumaustraliense\": [\n        \"1030-1887\"\n    ],\n    \"contributionsfromqueenslandherbarium\": [\n        \"2202-0802\"\n    ],\n    \"contrunivmichiganherb\": [\n        \"0091-1860\"\n    ],\n    \"contrusnatlherb\": [\n        \"0097-1618\"\n    ],\n    \"curtissbotanicalmagazine\": [\n        \"1355-4905\"\n    ],\n    \"curtissbotanicalmagazineappendixcompaniontobotanicalmagazine\": [\n        \"1355-4905\"\n    ],\n    \"curtissbotanicalmagazinenewseries\": [\n        \"1355-4905\"\n    ],\n    \"curtissbotanicalmagazinens\": [\n        \"1355-4905\"\n    ],\n    \"curtissbotmag\": [\n        \"1355-4905\"\n    ],\n    \"danskbotark\": [\n        \"0011-6211\"\n    ],\n    \"darwiniana\": [\n        \"0011-6793\"\n    ],\n    \"edinburghjbot\": [\n        \"0960-4286\"\n    ],\n    \"edinburghjournalbotany\": [\n        \"0960-4286\"\n    ],\n    \"eurjtaxon\": [\n        \"2118-9773\"\n    ],\n    \"feddesrepert\": [\n        \"0014-8962\"\n    ],\n    \"femsyeastresearch\": [\n        \"1567-1356\"\n    ],\n    \"ferngaz\": [\n        \"0308-0838\"\n    ],\n    \"ferngazuk\": [\n        \"0308-0838\"\n    ],\n    \"fieldianabot\": [\n        \"0015-0746\"\n    ],\n    \"flcongobelgeruandaurundi\": [\n        \"0374-6313\"\n    ],\n    \"flmalesserspermat\": [\n        \"0071-5778\"\n    ],\n    \"flneotropmonogr\": [\n        \"0071-5794\"\n    ],\n    \"floramontiber\": [\n        \"1138-5952\"\n    ],\n    \"foliageobotphytotax\": [\n        \"0015-5551\"\n    ],\n    \"foliamalaysiana\": [\n        \"1511-8916\"\n    ],\n    \"fontqueria\": [\n        \"0212-0623\"\n    ],\n    \"forumgeobot\": [\n        \"1867-9315\"\n    ],\n    \"fritschiana\": [\n        \"1024-0306\"\n    ],\n    \"fungaldiversity\": [\n        \"1560-2745\"\n    ],\n    \"gardbullsingapore\": [\n        \"0374-7859\",\n        \"217697\"\n    ],\n    \"gardensbulletinsingapore\": [\n        \"0374-7859\"\n    ],\n    \"gardensbulletinsingaporemaywlchewflaustralia\": [\n        \"0374-7859\"\n    ],\n    \"gartenflora\": [\n        \"0177-0349\"\n    ],\n    \"gayana\": [\n        \"0016-5301\"\n    ],\n    \"gayanabot\": [\n        \"0016-5301\"\n    ],\n    \"gayanabotánica\": [\n        \"0717-6643\"\n    ],\n    \"genetica\": [\n        \"0016-6707\"\n    ],\n    \"genschefflerasabah\": [\n        \"2398-6336\"\n    ],\n    \"globalfl\": [\n        \"2398-6336\"\n    ],\n    \"grana\": [\n        \"0017-3134\"\n    ],\n    \"greatbasinnaturalist\": [\n        \"0017-3614\"\n    ],\n    \"guihaia\": [\n        \"1000-3142\"\n    ],\n    \"harvardpapbot\": [\n        \"1043-4534\"\n    ],\n    \"harvardpapersbotany\": [\n        \"1043-4534\"\n    ],\n    \"haseltonia\": [\n        \"1070-0048\"\n    ],\n    \"hoehnea\": [\n        \"0073-2877\"\n    ],\n    \"ibugana\": [\n        \"0187-7054\"\n    ],\n    \"iheringiabot\": [\n        \"0073-4705\"\n    ],\n    \"intjplsci\": [\n        \"1058-5893\"\n    ],\n    \"jadelaidebotgard\": [\n        \"0313-4083\"\n    ],\n    \"jagrictropbotappl\": [\n        \"0021-7662\"\n    ],\n    \"jarnoldarbor\": [\n        \"0004-2625\"\n    ],\n    \"jassocstraits\": [\n        \"2304-7534\"\n    ],\n    \"jbamboores\": [\n        \"1000-6567\"\n    ],\n    \"jbiogeogr\": [\n        \"0305-0270\"\n    ],\n    \"jbombaynathistsoc\": [\n        \"0006-6982\"\n    ],\n    \"jbotresinsttexas\": [\n        \"1934-5259\"\n    ],\n    \"jbotsocbotfrance\": [\n        \"1280-8202\"\n    ],\n    \"jeafrnathist\": [\n        \"1026-1613\"\n    ],\n    \"jgeobot\": [\n        \"0374-8081\"\n    ],\n    \"jgeobothokuriku\": [\n        \"0374-8081\"\n    ],\n    \"jintconiferpreservsoc\": [\n        \"1075-3524\"\n    ],\n    \"jjapbot\": [\n        \"0022-2062\"\n    ],\n    \"jlinnsocbot\": [\n        \"0368-2927\"\n    ],\n    \"jnanjingforestunivnatscied\": [\n        \"1000-2006\"\n    ],\n    \"journagrictropbotappliq\": [\n        \"0021-7662\"\n    ],\n    \"journaladelaidebotanicgardens\": [\n        \"0313-4083\"\n    ],\n    \"journallinneansocietybotany\": [\n        \"0368-2927\"\n    ],\n    \"journalroyalsocietywesternaustralia\": [\n        \"0035-922X\"\n    ],\n    \"journalwashingtonacademysciences\": [\n        \"0043-0439\"\n    ],\n    \"journjapbot\": [\n        \"0022-2062\"\n    ],\n    \"jproclinnsocbot\": [\n        \"1945-9483\"\n    ],\n    \"jroysocwesternaustralia\": [\n        \"0035-922X\"\n    ],\n    \"jsafricanbot\": [\n        \"0022-4618\"\n    ],\n    \"jstraitsbranchroyasiatsoc\": [\n        \"2304-7534\"\n    ],\n    \"jsystevol\": [\n        \"1674-4918\"\n    ],\n    \"jthreattaxa\": [\n        \"0974-7893\"\n    ],\n    \"jtropsubtropbot\": [\n        \"1005-3395\"\n    ],\n    \"jwashacadsci\": [\n        \"0043-0439\"\n    ],\n    \"jwuhanbotres\": [\n        \"1000-470X\"\n    ],\n    \"kalikasan\": [\n        \"0115-0553\"\n    ],\n    \"kalmia\": [\n        \"0080-4274\"\n    ],\n    \"kanunnah\": [\n        \"1832-536X\"\n    ],\n    \"kewbull\": [\n        \"0075-5974\"\n    ],\n    \"kewbulletin\": [\n        \"0075-5974\"\n    ],\n    \"kirkia\": [\n        \"0451-9930\"\n    ],\n    \"komarovia\": [\n        \"1819-0154\"\n    ],\n    \"koreanjpltaxon\": [\n        \"1225-8318\"\n    ],\n    \"lankesteriana\": [\n        \"1409-3871\"\n    ],\n    \"lichenologist\": [\n        \"0024-2829\"\n    ],\n    \"lindleyana\": [\n        \"0889-258X\"\n    ],\n    \"lundellia\": [\n        \"1097-993X\"\n    ],\n    \"madroño\": [\n        \"0024-9637\"\n    ],\n    \"malayannatj\": [\n        \"0025-1291\"\n    ],\n    \"mededbotmusherbrijksunivutrecht\": [\n        \"2352-5754\"\n    ],\n    \"memamacadartssc\": [\n        \"0096-6134\"\n    ],\n    \"memameracad\": [\n        \"0096-6134\"\n    ],\n    \"memameracadarts\": [\n        \"0096-6134\"\n    ],\n    \"memameracadartsser\": [\n        \"0096-6134\"\n    ],\n    \"memjuntainvestultramarser\": [\n        \"0870-0915\"\n    ],\n    \"memmushistnatparisserbot\": [\n        \"0078-9755\"\n    ],\n    \"memnamacadartssc\": [\n        \"0096-6134\"\n    ],\n    \"memnewyorkbotgard\": [\n        \"0077-8931\"\n    ],\n    \"memoirsamericanacademyartssciences\": [\n        \"0096-6134\"\n    ],\n    \"memoirsamericanacademyartssciencesser\": [\n        \"0096-6134\"\n    ],\n    \"memoirsamericanacademysciences\": [\n        \"0096-6134\"\n    ],\n    \"memoirstorreybotanicalclub\": [\n        \"0097-3807\"\n    ],\n    \"memtorreybotclub\": [\n        \"0097-3807\"\n    ],\n    \"micronesica\": [\n        \"0026-279X\"\n    ],\n    \"mittbotstaatssammlmünchen\": [\n        \"0006-8179\"\n    ],\n    \"molecphylogenevol\": [\n        \"1055-7903\",\n        \"0102-3306\"\n    ],\n    \"monogrsystbotmissouribotgard\": [\n        \"0161-1542\"\n    ],\n    \"moscosoa\": [\n        \"0254-6442\"\n    ],\n    \"muelleria\": [\n        \"0077-1813\"\n    ],\n    \"métecolsist\": [\n        \"1659-3049\"\n    ],\n    \"nathistbullsiamsoc\": [\n        \"0080-9462\"\n    ],\n    \"nelumbo\": [\n        \"0976-5069\"\n    ],\n    \"neodiversity\": [\n        \"1809-5348\"\n    ],\n    \"newjbot\": [\n        \"2042-3489\"\n    ],\n    \"newzealandjbot\": [\n        \"0028-825X\"\n    ],\n    \"newzealandjournalbotany\": [\n        \"0028-825X\"\n    ],\n    \"nordicjbot\": [\n        \"0107-055X\"\n    ],\n    \"nordicjournalbotany\": [\n        \"0107-055X\"\n    ],\n    \"norwegjbot\": [\n        \"0300-1156\"\n    ],\n    \"notesroybotgardedinburgh\": [\n        \"0080-4274\"\n    ],\n    \"notizblbotgartberlindahlem\": [\n        \"0258-1485\"\n    ],\n    \"notizblköniglbotgartberlin\": [\n        \"0258-1485\"\n    ],\n    \"notulsystparis\": [\n        \"0374-9223\"\n    ],\n    \"nouvarchmushistnat\": [\n        \"0766-7248\"\n    ],\n    \"novon\": [\n        \"1055-3177\"\n    ],\n    \"novostisistvysshrast\": [\n        \"0568-5435\"\n    ],\n    \"nuytsia\": [\n        \"0085-4417\"\n    ],\n    \"occaspapcalifacadsci\": [\n        \"0068-5461\"\n    ],\n    \"oesterrbotwochenbl\": [\n        \"1029-0729\"\n    ],\n    \"oesterrbotz\": [\n        \"0029-8948\"\n    ],\n    \"operabot\": [\n        \"0078-5237\"\n    ],\n    \"organismsdiversityevol\": [\n        \"1439-6092\"\n    ],\n    \"orquideologia\": [\n        \"0120-1433\"\n    ],\n    \"pacificsci\": [\n        \"0030-8870\"\n    ],\n    \"parazitologiya\": [\n        \"0031-1847\"\n    ],\n    \"philippjsci\": [\n        \"0031-7683\"\n    ],\n    \"philippjscic\": [\n        \"0370-0208\"\n    ],\n    \"philippscientist\": [\n        \"0079-1466\"\n    ],\n    \"philtransroysoclondserb\": [\n        \"0962-8436\"\n    ],\n    \"phytokeys\": [\n        \"1314-2011\"\n    ],\n    \"phytologia\": [\n        \"0031-9430\"\n    ],\n    \"phytoneuron\": [\n        \"2153-733X\"\n    ],\n    \"phytonhorn\": [\n        \"0079-2047\"\n    ],\n    \"phytotaxa\": [\n        \"1179-3155\"\n    ],\n    \"plants[basel]\": [\n        \"2223-7747\"\n    ],\n    \"plbiosystems\": [\n        \"1126-3504\"\n    ],\n    \"pldiversevol\": [\n        \"1869-6155\"\n    ],\n    \"pldiversityresources\": [\n        \"2095-0845\"\n    ],\n    \"plecolevol\": [\n        \"2032-3913\"\n    ],\n    \"plosone\": [\n        \"1932-6203\"\n    ],\n    \"plosonee[oct][epublished]\": [\n        \"1932-6203\"\n    ],\n    \"plscij\": [\n        \"2095-0837\"\n    ],\n    \"plsystevol\": [\n        \"0378-2697\"\n    ],\n    \"polishbotj\": [\n        \"1641-8190\"\n    ],\n    \"procacadnatsciphiladelphia\": [\n        \"0097-3157\"\n    ],\n    \"procameracadarts\": [\n        \"0199-9818\"\n    ],\n    \"procamerphilossoc\": [\n        \"0003-049X\"\n    ],\n    \"procbiolsocwashington\": [\n        \"0006-324X\"\n    ],\n    \"proccalifacadsci\": [\n        \"0068-547X\"\n    ],\n    \"proceedingslinneansocietynewsouthwales\": [\n        \"0370-047X\"\n    ],\n    \"proclinnsocnewsouthwales\": [\n        \"0370-047X\"\n    ],\n    \"procroysocedinb\": [\n        \"0370-1646\"\n    ],\n    \"procroysocqueensland\": [\n        \"0080-469X\"\n    ],\n    \"publfieldcolumbianmusbotser\": [\n        \"0096-2759\"\n    ],\n    \"publfieldcolumbmusbotser\": [\n        \"0096-2759\"\n    ],\n    \"publfieldmusnathistbotser\": [\n        \"0096-2759\"\n    ],\n    \"pyrexjbiodiversconservation\": [\n        \"2985-8844\"\n    ],\n    \"recaucklandinstmus\": [\n        \"0067-0464\"\n    ],\n    \"recaucklinstmus\": [\n        \"0067-0464\"\n    ],\n    \"recueiltravbotnéerl\": [\n        \"0370-7504\"\n    ],\n    \"reinwardtia\": [\n        \"0034-365X\"\n    ],\n    \"repertoriumnovarumspecierumregnivegetabilis\": [\n        \"0375-121X\"\n    ],\n    \"repertspecnovregniveg\": [\n        \"0375-121X\"\n    ],\n    \"repertspecnovregnivegbeih\": [\n        \"0233-187X\"\n    ],\n    \"revbotapplagrictrop\": [\n        \"0370-3681\"\n    ],\n    \"revfacagronmaracay\": [\n        \"0041-8285\"\n    ],\n    \"revintbotapplagrictrop\": [\n        \"0370-5412\"\n    ],\n    \"revistaacadcolombciexact\": [\n        \"0370-3908\"\n    ],\n    \"revistabrasilbot\": [\n        \"0100-8404\"\n    ],\n    \"revistafacagronmaracay\": [\n        \"0041-8285\"\n    ],\n    \"revistaguatemal\": [\n        \"1562-7217\"\n    ],\n    \"revistaguatemalensis\": [\n        \"1562-7217\"\n    ],\n    \"revistajardbotnacunivhabana\": [\n        \"0253-5696\"\n    ],\n    \"revistamexbiodivers\": [\n        \"1870-3453\"\n    ],\n    \"revistamusplata\": [\n        \"0375-1147\"\n    ],\n    \"revistamusplataseccbot\": [\n        \"0372-4611\",\n        \"0375-1147\"\n    ],\n    \"revistaperubiol\": [\n        \"1561-0837\"\n    ],\n    \"revistasocbolivbot\": [\n        \"2076-3190\"\n    ],\n    \"revjardbotnacionunivhabana\": [\n        \"0253-5696\"\n    ],\n    \"rheedea\": [\n        \"0971-2313\"\n    ],\n    \"rhodora\": [\n        \"0035-4902\"\n    ],\n    \"richardiana\": [\n        \"1626-3596\"\n    ],\n    \"richardianans\": [\n        \"2262-9017\"\n    ],\n    \"rodriguésia\": [\n        \"0370-6583\"\n    ],\n    \"safricanjbot\": [\n        \"0254-6299\"\n    ],\n    \"sarawakmusj\": [\n        \"0581-7897\"\n    ],\n    \"sarawakmusjourn\": [\n        \"0581-7897\"\n    ],\n    \"schlechtendalia\": [\n        \"1436-2317\"\n    ],\n    \"schütziana\": [\n        \"2191-3099\"\n    ],\n    \"selbyana\": [\n        \"0361-185X\"\n    ],\n    \"sendtnera\": [\n        \"0944-0178\"\n    ],\n    \"sida\": [\n        \"0036-1488\"\n    ],\n    \"sidabotmisc\": [\n        \"0883-1475\"\n    ],\n    \"smithsoniancontrbot\": [\n        \"0081-024X\"\n    ],\n    \"smithsoniancontributionstobotany\": [\n        \"0081-024X\"\n    ],\n    \"smithsonianmisccollect\": [\n        \"0096-8749\"\n    ],\n    \"southwnaturalist\": [\n        \"0038-4909\"\n    ],\n    \"stapfia\": [\n        \"0252-192X\"\n    ],\n    \"svenskbottidskr\": [\n        \"0039-646X\"\n    ],\n    \"systbot\": [\n        \"0363-6445\"\n    ],\n    \"systbotmonogr\": [\n        \"0737-8211\"\n    ],\n    \"systematicbotany\": [\n        \"0363-6445\"\n    ],\n    \"systgeogrpl\": [\n        \"1374-7886\"\n    ],\n    \"taiwania\": [\n        \"0372-333X\"\n    ],\n    \"tapchísinhhọc\": [\n        \"0866-7160\"\n    ],\n    \"taprobanica\": [\n        \"1800-427X\"\n    ],\n    \"taxon\": [\n        \"0040-0262\"\n    ],\n    \"taxonomania\": [\n        \"1783-0362\"\n    ],\n    \"telopea\": [\n        \"0312-9764\"\n    ],\n    \"thaiforestbullbot\": [\n        \"0495-3843\"\n    ],\n    \"transactionsproceedingsroyalsocietysouthaustralia\": [\n        \"0372-1426\"\n    ],\n    \"transbotsocedinburgh\": [\n        \"0374-6607\"\n    ],\n    \"translinnsoclondon\": [\n        \"1945-9432\"\n    ],\n    \"translinnsoclondonbot\": [\n        \"1945-9459\"\n    ],\n    \"transprocbotsocedin\": [\n        \"0374-6607\"\n    ],\n    \"transprocbotsocedinb\": [\n        \"0374-6607\"\n    ],\n    \"transprocbotsocedinburgh\": [\n        \"0374-6607\"\n    ],\n    \"transprocroysocsaustral\": [\n        \"0372-1426\"\n    ],\n    \"transprocroysocsouthaustralia\": [\n        \"0372-1426\"\n    ],\n    \"transroysocsouthafrica\": [\n        \"0035-919X\"\n    ],\n    \"transsafricanphilossoc\": [\n        \"2156-0382\"\n    ],\n    \"transsandiegosocnathist\": [\n        \"0080-5947\"\n    ],\n    \"turczaninowia\": [\n        \"1560-7259\"\n    ],\n    \"turkishjbot\": [\n        \"1300-008X\"\n    ],\n    \"ukrayinskbotzhurn\": [\n        \"0372-4123\"\n    ],\n    \"utafiti\": [\n        \"1015-8707\"\n    ],\n    \"verhandlungenkaiserlichk?niglichenzoologischbotanischengesellschaftwien\": [\n        \"0084-5647\"\n    ],\n    \"verhandlungenzoologischbotanischengesellschaftwien\": [\n        \"0084-5647\"\n    ],\n    \"verhbotvereinsprovbrandenburg\": [\n        \"0724-312X\"\n    ],\n    \"verhkkzoolbotgeswien\": [\n        \"0084-5647\"\n    ],\n    \"verhzoolbotges\": [\n        \"0084-5647\"\n    ],\n    \"verhzoolbotgeswien\": [\n        \"0084-5647\"\n    ],\n    \"verhzoolbotgesösterr\": [\n        \"0252-1911\"\n    ],\n    \"verhzoolbotgesösterreich\": [\n        \"0252-1911\"\n    ],\n    \"victoriannaturalist\": [\n        \"0042-5184\"\n    ],\n    \"vierteljahrsschrnaturfgeszürich\": [\n        \"0042-5672\"\n    ],\n    \"watsonia\": [\n        \"0043-1532\"\n    ],\n    \"webbia\": [\n        \"0083-7792\"\n    ],\n    \"weberbauerella\": [\n        \"2414-8814\"\n    ],\n    \"wentia\": [\n        \"0511-4780\"\n    ],\n    \"willdenowia\": [\n        \"0511-9618\"\n    ],\n    \"wrightia\": [\n        \"0084-2648\"\n    ],\n    \"wulfenia\": [\n        \"1561-882X\"\n    ],\n    \"yearbookheathersoc\": [\n        \"0440-5757\"\n    ],\n    \"znaturfc\": [\n        \"0939-5075\"\n    ],\n    \"菌物学报\": [\n        \"1672-6472\"\n    ]\n};\n\n//----------------------------------------------------------------------------------------\nfunction journal_to_issn (journal) {\n  var issn = '';\n  var key = finger_print(journal);\n  \n  if (issn_lookup[key]) {\n    issn = issn_lookup[key][0];\n  }\n  return issn;\n}\n\n//----------------------------------------------------------------------------------------\n// START COUCHDB VIEW\nfunction message(doc) {\n  if (doc.message) {\n\n    var subject_id = '';\n    \n    if (subject_id == '')\n    {\n\t\tif (doc.message.DOI) {    \t\n\t\t\tsubject_id = 'https://doi.org/' + doc.message.DOI.toLowerCase();\n\t\t}\n\t}\n\t\n    if (subject_id == '')\n    {\n\t\tif (doc.message.HANDLE) {    \t\n\t\t\tsubject_id = 'https://hdl.handle.net/' + doc.message.HANDLE.toLowerCase();\n\t\t}\n\t}\t\n\n    if (subject_id == '')\n    {\n\t\tif (doc.message.URL) {    \t\n\t\t\tsubject_id = doc.message.URL;\n\t\t}\n\t}\n\t\n\tif (subject_id == '')\n  {\n\t\tif (doc.message.PMID) {    \t\n\t\t\tsubject_id = 'https://www.ncbi.nlm.nih.gov/pubmed/' + doc.message.PMID;\n\t\t}\n\t}\n\t\n\t// HTTPS\n\tif (subject_id.match(/^http:\\/\\/(www\\.)?jstor/)) {\n\t  subject_id = subject_id.replace(/^http:/, 'https:');\n\t}\n    \n    var triples = [];\n    var type = '';\n    \n    // handle multilingual keys first so we don't duplicate them\n    \n    // title -----------------------------------------------------------------------------\n    var have_title = false;\n    if (doc.message.multi) {\n    \tif (doc.message.multi._key['title']) {\n    \t\thave_title = true;\n    \t\tfor (var k in doc.message.multi._key['title']) {\n    \t\t\ttriples.push(triple(subject_id,\n\t\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\t\tdoc.message.multi._key['title'][k], k));\n    \t\t}    \t\n    \t}\n    }\n    \n    if (!have_title) {\n    \tif (doc.message.title) {\n    \t  have_title = true;\n          if (Array.isArray(doc.message.title)) {\n            for (var j in doc.message.title) {\n\n              var lang = detect_language(doc.message.title[j]);\n\n              triples.push(triple(subject_id,\n                'http://schema.org/name',\n                doc.message.title[j], lang));\n            }\n          } else {\n            triples.push(triple(subject_id,\n              'http://schema.org/name',\n              doc.message.title));\n          }\n        }\n    }\n \n    // abstract --------------------------------------------------------------------------\n    var have_abstract = false;\n    if (doc.message.multi) {\n    \tif (doc.message.multi._key['abstract']) {\n    \t\thave_abstract = true;\n    \t\tfor (var k in doc.message.multi._key['abstract']) {\n    \t\t\ttriples.push(triple(subject_id,\n\t\t\t\t\t\t'http://schema.org/description',\n\t\t\t\t\t\tdoc.message.multi._key['abstract'][k], k));\n    \t\t}    \t\n    \t}\n    }\n    \n    if (!have_abstract) {\n    \tif (doc.message['abstract']) {\n    \t\t    have_abstract = true;\n    \t\t    \n    \t\t    var abstract_text = doc.message['abstract'];\n    \t\t    \n            // fix JATS tags\n            abstract_text = abstract_text.replace(/<jats:title>/g, ' <i>');\n            abstract_text = abstract_text.replace(/<\\/jats:title>/g, '</i>');\n            abstract_text = abstract_text.replace(/<jats:p>/g, '<p>');\n            abstract_text = abstract_text.replace(/<\\/jats:p>/g, '</p>');\n            abstract_text = abstract_text.replace(/<jats:italic>/g, ' <i>');\n            abstract_text = abstract_text.replace(/<\\/jats:italic>/g, '</i>');\n    \t\t    \n            triples.push(triple(subject_id,\n              'http://schema.org/description',\n              abstract_text));\n        }\n    }\n \t\n\t\n    // container -------------------------------------------------------------------------\n    var container_id = '';    \n       \n    if (doc.message.ISSN) {\n    \tcontainer_id = 'http://worldcat.org/issn/' + doc.message.ISSN[0];\n    \t\n\t  triples.push(triple(container_id,\n\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t'http://schema.org/Periodical'));\n    \t\n    } else {\n    \tcontainer_id = subject_id + '#container';\n    }\n    \n    \n    if (container_id != '') {\n    \ttriples.push(triple(subject_id,\n              'http://schema.org/isPartOf',\n              container_id));\n              \n        var have_container_title = false;      \n           \n          \n\t\tif (doc.message.multi) {\n\t\t\tif (doc.message.multi._key['container-title']) {\n\t\t\t\thave_container_title = true;\n\t\t\t\tfor (var k in doc.message.multi._key['container-title']) {\n\t\t\t\t\ttriples.push(triple(container_id,\n\t\t\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\t\t\tdoc.message.multi._key['container-title'][k], k));\n\t\t\t\t}    \t\n\t\t\t}\n\t\t}\n\t    \n\t\tif (!have_container_title) {\n\t\t\tif (doc.message['container-title']) {\n\t\t\t\thave_container_title = true;\n\t\t\t\t\n\t\t\t\tif (Array.isArray(doc.message['container-title'])) {\n           \t\t\tfor (var j in doc.message['container-title']) {\n \t          \t\t\ttriples.push(triple(container_id,\n\t\t\t\t\t\t  'http://schema.org/name',\n\t\t\t\t\t\t  doc.message['container-title'][j]));  \n           \t\t\t}\n           \t\t} else {\n\t\t\t\t\ttriples.push(triple(container_id,\n\t\t\t\t\t  'http://schema.org/name',\n\t\t\t\t\t  doc.message['container-title']));           \t\t\n           \t\t}\n\t\t\t}\n\t\t} \n\t\t            \n    }\n\n    for (var i in doc.message) {\n      switch (i) {\n      \n      \t// identifiers\n        case 'DOI':\n      \t\tvar identifier_id = subject_id + '#doi';\n      \t\t\n      \t\ttriples.push(triple(subject_id,\n              'http://schema.org/identifier',\n              identifier_id));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n              'http://schema.org/PropertyValue'));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/propertyID',\n              'doi'));\n \n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/value',\n              doc.message[i].toLowerCase()));\n\t\t\tbreak;   \n\t\t\t\n\t\t// Handle, JSTOR, etc.\n     \t// identifiers\n        case 'HANDLE':\n      \t\tvar identifier_id = subject_id + '#handle';\n      \t\t\n      \t\ttriples.push(triple(subject_id,\n              'http://schema.org/identifier',\n              identifier_id));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n              'http://schema.org/PropertyValue'));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/propertyID',\n              'handle'));\n \n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/value',\n              doc.message[i].toLowerCase()));\n\t\t\tbreak;  \n\t\t\t\n       case 'JSTOR':\n      \t\tvar identifier_id = subject_id + '#jstor';\n      \t\t\n      \t\ttriples.push(triple(subject_id,\n              'http://schema.org/identifier',\n              identifier_id));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n              'http://schema.org/PropertyValue'));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/propertyID',\n              'jstor'));\n \n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/value',\n              doc.message[i].toLowerCase()));\n\t\t\tbreak;  \n\t\t\t\n\t\t\t\n       case 'PMID':\n      \t\tvar identifier_id = subject_id + '#pmid';\n      \t\t\n      \t\ttriples.push(triple(subject_id,\n              'http://schema.org/identifier',\n              identifier_id));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n              'http://schema.org/PropertyValue'));\n\n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/propertyID',\n              'pmid'));\n \n      \t\ttriples.push(triple(identifier_id,\n              'http://schema.org/value',\n              doc.message[i].toString()));\n\t\t\tbreak;  \t\t\t\n\t\t\n\n/*\n        case 'DOI':\n          triples.push(triple(subject_id,\n            'http://schema.org/identifier',\n            'http://identifiers.org/doi/' + doc.message[i].toLowerCase()));\n          break;\n\n        case 'URL':\n          triples.push(triple(subject_id,\n            'http://schema.org/url',\n            doc.message[i]));\n          break;\n          \n        case 'alternative-id':\n\t\t\tfor (var j in doc.message[i]) {\n\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t'http://schema.org/identifier',\n\t\t\t\tdoc.message[i][j]));\n\t\t\t}\n\t\t\tbreak;  \n*/\t\t\t    \n\t\t\t\n\t\tcase 'type':\n\t\t\tswitch (doc.message[i]) {\n\t\t\t  case 'article-journal':\n\t\t\t  case 'journal-article':\n\t\t\t    type = 'http://schema.org/ScholarlyArticle';\n\t\t\t\tbreak;\n\t\t\t  default:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\t\t// article metadata\n\t\t  case 'issue':\n\t\t\ttriples.push(triple(subject_id,\n\t\t\t  'http://schema.org/issueNumber',\n\t\t\t  doc.message[i]));\n\t\t\tbreak;\n\n\t\t  case 'pages':\n\t\t\ttriples.push(triple(subject_id,\n\t\t\t  'http://schema.org/pagination',\n\t\t\t  doc.message[i]));\n\t\t\tbreak;\n\n\t\t  case 'volume':\n\t\t\ttriples.push(triple(subject_id,\n\t\t\t  'http://schema.org/volumeNumber',\n\t\t\t  doc.message[i]));\n\t\t\tbreak;\n\t\t\n\t\t  case 'page':\n\t\t\tvar parts = doc.message[i].match(/^(.*)\\-(.*)$/);\n\t\t\tif (parts) {\n\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t'http://schema.org/pageStart',\n\t\t\t\tparts[1]));\n\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t'http://schema.org/pageEnd',\n\t\t\t\tparts[2]));\n\t\t\t} else {\n\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t'http://schema.org/pagination',\n\t\t\t\tdoc.message[i]));\n\t\t\t}\n\t\t\tbreak;\n\t\t\n\t  case 'issued':\n\t     var date = '';\n\t     var dateparts = doc.message[i]['date-parts'][0];\n\t     \n\t     switch (dateparts.length) {\n\t        case 1:\n\t           date = dateparts[0];\n\t           break;\n\t        case 2:\n\t           date = dateparts[0] + '-' + (\"00\" + dateparts[1]).slice(-2) + '-00';\n\t           break;\n\t        case 3:\n\t           date = dateparts[0] + '-' + (\"00\" + dateparts[1]).slice(-2) + '-' + (\"00\" + dateparts[2]).slice(-2);\t           \n\t           break;\n\t        default:\n\t        \tbreak;\n\t    }\n\t    triples.push(triple(subject_id,\n          'http://schema.org/datePublished',\n          date.toString()));\t    \n\t    break;\n                   \n\t\t\t// tags\n\t\t  case 'subject':\n\t\t\tfor (var j in doc.message[i]) {\n\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t'http://schema.org/keywords',\n\t\t\t\tdoc.message[i][j]));\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t// license\n\t\t  case 'license':\n\t\t\tfor (var j in doc.message[i]) {\n\t\t\t  if (doc.message[i][j].URL) {\n\t\t\t\ttriples.push(triple(subject_id,\n\t\t\t\t  'http://schema.org/license',\n\t\t\t\t  doc.message[i][j].URL));\n\t\t\t  }\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t// publisher\n\t\t\t// should this be linked to journal rather than article?\n\t\t\t// should this be an object rather than a string?\n\t\t  case 'publisher':\n\t\t\ttriples.push(triple(subject_id,\n\t\t\t  'http://schema.org/publisher',\n\t\t\t  doc.message[i]));\n\t\t\tbreak;\n\t\t\t\n\t\t  case 'ISSN':\n\t\t\t  // ISSNs\n\t\t\tfor (var j in doc.message[i]) {\n\t\t\t  // issn\n\t\t\t  triples.push(triple(container_id,\n\t\t\t\t'http://schema.org/issn',\n\t\t\t\tdoc.message[i][j]));\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t// authors (may include ORCIDs or possibly other identifiers)\n\t\t\t// create an identifier to make this addressable\n\t\t  case 'author':\n\t\t\tvar n = doc.message[i].length;\n\t\t\t\t\t\t\n\t\t\tfor (var j = 0; j < n; j++) {\n\t\t\t\tvar index = parseInt(j) + 1;\n            \tvar role_id    = subject_id + '#role-' + index;            \t\n            \tvar creator_id = subject_id + '#creator-' + index;\n            \t\n            \t// role\n\t\t\t\ttriples.push(triple(\n\t\t\t\t\tsubject_id,\n\t\t\t\t\t'http://schema.org/creator',\n\t\t\t\t\trole_id)\n\t\t\t\t\t);\n\n\t\t\t\ttriples.push(triple(\n\t\t\t\t\trole_id,\n\t\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t'http://schema.org/Role')\n\t\t\t\t\t);\n\n\t\t\t\ttriples.push(triple(\n\t\t\t\t\trole_id,\n\t\t\t\t\t'http://schema.org/roleName',\n\t\t\t\t\tString(index)\n\t\t\t\t\t));\n\n\t\t\t\ttriples.push(triple(\n\t\t\t\t\trole_id,\n\t\t\t\t\t'http://schema.org/creator',\n\t\t\t\t\tcreator_id\n\t\t\t\t\t));            \t\n\t\t\t\t\n\t\t\t\t // creator \n\t\t\t\t\n\t\t\t\t  // type, need to handle organisations as authors\n\t\t\t\t  triples.push(triple(\n\t\t\t\t\tcreator_id,\n\t\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t'http://schema.org/Person'));\n\t\t\t\t\t\t\t\t\n\t\t\t\t  // name, which may be multilingual                \n\t\t\t\t\tif (doc.message[i][j]['multi']) {\n\t\t\t\t\t  if (doc.message[i][j]['multi']._key['literal']) {\n\t\t\t\t\t\tfor (var k in doc.message[i][j]['multi']._key['literal']) {\t\t\t\t  \n\t\t\t\t\t\t  triples.push(triple(creator_id,\n\t\t\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\t\t\tdoc.message[i][j]['multi']._key['literal'][k], k));  \n\t\t\t\t\t\t}\n\t\t\t\t\t  }\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// one or more strings\n\t\t\t\t\t\t\n\t\t\t\t\t   var person_name;\n\t\t\t\t\t\tif (doc.message[i][j].literal) {\n\t\t\t\t\t\t  person_name = doc.message[i][j].literal;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t  var parts = [];\n\t\t\t\t\t\t  if (doc.message[i][j].given) {\n\t\t\t\t\t\t\tparts.push(doc.message[i][j].given); \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttriples.push(triple(creator_id,\n\t\t\t\t  \t\t\t\t'http://schema.org/givenName', // ?\n\t\t\t\t  \t\t\t\tdoc.message[i][j].given));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t  if (doc.message[i][j].family) {\n\t\t\t\t\t\t\tparts.push(doc.message[i][j].family); \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttriples.push(triple(creator_id,\n\t\t\t\t  \t\t\t\t'http://schema.org/familyName', // ?\n\t\t\t\t  \t\t\t\tdoc.message[i][j].family));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t  person_name = parts.join(' ');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t  triples.push(triple(\n\t\t\t\t\t\tcreator_id,\n\t\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\t\tperson_name));\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t} \n\t\t\t\t\t\n\t\t\t\t\t// identifier(s)\n\t\t\t\t\tif (doc.message[i][j].ORCID) {\n\t\t\t\t\t\tvar identifier_id = creator_id + '-orcid';\n\t           \t\t\tvar orcid = doc.message[i][j].ORCID;\n            \t\t\torcid = orcid.replace(/https?:\\/\\/orcid.org\\//, '');\n            \t\t\t\n\t\t\t\t\t\ttriples.push(triple(\n\t\t\t\t\t\t  creator_id,\n\t\t\t\t\t\t  'http://schema.org/identifier',\n\t\t\t\t\t\t  identifier_id));\n\t\t\t\t\t\t\n\t\t\t\t\t\ttriples.push(triple(\n\t\t\t\t\t\t  identifier_id,\n\t\t\t\t\t\t  'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t\t  'http://schema.org/PropertyValue'));\n\n\t\t\t\t\t\ttriples.push(triple(\n\t\t\t\t\t\t  identifier_id,\n\t\t\t\t\t\t  'http://schema.org/propertyID',\n\t\t\t\t\t\t  'orcid'));\n\n\t\t\t\t\t\ttriples.push(triple(\n\t\t\t\t\t\t  identifier_id,\n\t\t\t\t\t\t  'http://schema.org/value',\n\t\t\t\t\t\t  orcid\n\t\t\t\t\t\t));                          \t\t\t            \t\t\t\n            \t\t}\n\t\n\t\t\t}\n\t\t\tbreak;\t\n\t\t\t\t\n\t\t\t\n          /*\n\t\t\t// funding\n\t\t  case 'funder':\n\t\t\tvar n = doc.message[i].length;\n\t\t\tfor (var j = 0; j < n; j++) {\n\t\t\t  var funder_id = '';\n\n\t\t\t  // create identifier for funder\n\t\t\t  if (doc.message[i][j].DOI) {\n\t\t\t\tfunder_id = 'http://identifiers.org/doi/' + doc.message[i][j].DOI;\n\t\t\t  } else {\n\t\t\t\t// #hash identifier \n\t\t\t\tfunder_id = subject_id + '#funder_' + (j + 1);\n\t\t\t  }\n\n\t\t\t  // create funder \n\t\t\t  triples.push(triple(funder_id,\n\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t'http://schema.org/Organisation'));\n\n\t\t\t  triples.push(triple(funder_id,\n\t\t\t\t'http://schema.org/name',\n\t\t\t\tdoc.message[i][j].name));\n\n\t\t\t  // role\n\t\t\t  var m = doc.message[i][j].award.length;\n\n\t\t\t  if (m == 0) {\n\t\t\t\t// funder but award not known\n\t\t\t\tvar award_id = funder_id + '/award';\n\n\t\t\t\ttriples.push(triple(award_id,\n\t\t\t\t  'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t  'http://schema.org/Role'));\n\n\t\t\t\t// link to funder \n\t\t\t\ttriples.push(triple(award_id,\n\t\t\t\t  'http://schema.org/funder',\n\t\t\t\t  funder_id));\n\n\t\t\t\t// link role to work         \n\t\t\t\ttriples.push(triple(subject_id,\n\t\t\t\t  'http://schema.org/funder',\n\t\t\t\t  award_id));\n\t\t\t  } else {\n\t\t\t\t// we have one or more awards\n\t\t\t\tfor (var a = 0; a < m; a++) {\n\t\t\t\t  var award_id = funder_id + '/award_' + (a+1);\n\n\t\t\t\t  triples.push(triple(award_id,\n\t\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t'http://schema.org/Role'));\n\n\t\t\t\t  triples.push(triple(award_id,\n\t\t\t\t\t'http://schema.org/roleName',\n\t\t\t\t\tdoc.message[i][j].award[a]\n\t\t\t\t  ));\n\n\t\t\t\t  // link to funder \n\t\t\t\t  triples.push(triple(award_id,\n\t\t\t\t\t'http://schema.org/funder',\n\t\t\t\t\tfunder_id));\n\n\t\t\t\t  // link role to work         \n\t\t\t\t  triples.push(triple(subject_id,\n\t\t\t\t\t'http://schema.org/funder',\n\t\t\t\t\taward_id));\n\t\t\t\t}\n\t\t\t  }\n\t\t\t}\n\t\t\tbreak;\n\t\t\t*/\n\t\t\t\n\t\t\t/*\n\n\t\t\t// links to representions such as PDFs, XML, HTML, etc.\n\t\t\t// may be links to text mining sources\n\t\t  case 'link':\n\t\t\tvar n = doc.message[i].length;\n\t\t\tfor (var j = 0; j < n; j++) {\n\t\t\t  var link_id = subject_id + '#link_' + (j + 1);\n\n\t\t\t  // type\n\t\t\t  triples.push(triple(link_id,\n\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t'http://schema.org/CreativeWork'));\n\n\t\t\t  if (doc.message[i][j].URL) {\n\t\t\t\ttriples.push(triple(link_id,\n\t\t\t\t  'http://schema.org/url',\n\t\t\t\t  doc.message[i][j].URL));\n\n\t\t\t\tif (doc.message[i][j]['content-type']) {\n\t\t\t\t  triples.push(triple(link_id,\n\t\t\t\t\t'http://schema.org/fileFormat',\n\t\t\t\t\tdoc.message[i][j]['content-type']));\n\t\t\t\t}\n\n\t\t\t\t// link to work\n\t\t\t\ttriples.push(triple(subject_id,\n\t\t\t\t  'http://schema.org/workExample',\n\t\t\t\t  link_id));\n\t\t\t  }\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t*/\n\n\n/*\n      \"reference\": [\n           {\n               \"key\": \"11192_B1\",\n               \"first-page\": \"119\",\n               \"article-title\": \"Pseudocrangonyx, a new genus of subterranean amphipods from Japan.\",\n               \"volume\": \"10\",\n               \"author\": \"Akatsuka\",\n               \"year\": \"1922\",\n               \"journal-title\": \"Annotationes Zoologicae Japonenses\"\n           },\n           \n\t\t{\n\t\tkey: \"ref32\",\n\t\tfirst-page: \"1\",\n\t\tarticle-title: \"Exkursionsflora für die Kanarischen Inseln. Verlag Eugen Ulmer, Stuttgart. Hughes, C. 1998. Monograph of Leucaena (Leguminosae- Mimosoideae).\",\n\t\tvolume: \"55\",\n\t\tauthor: \"Hohenester\",\n\t\tyear: \"1993\",\n\t\tjournal-title: \"Syst. Bot. Monogr.\",\n\t\tISSN: \"http://id.crossref.org/issn/0737-8211\",\n\t\tissn-type: \"print\"\n\t\t}\n           \n */\n \n \n \t\t  case 'reference':\n\t\t\tvar n = doc.message[i].length;\n\t\t\tfor (var j = 0; j < n; j++) {\n\t\t\t  \n\t\t\t  // by default use key as identifier, but if we have a DOI use that\n\t\t\t  \n\t\t\t  // use key as identifier, but clean first\n\t\t\t  var key = doc.message[i][j].key;\n\t\t\t  \n        key = key.replace(/\\t/g, '');\n        key = key.replace(/\\n/g, '');\n\n        // replace characters not allowed\n        key = key.replace(/\\|/g, '-');\n        key = key.replace(/\\//g, '-');\n        key = key.replace(/\\./g, '-');\n        key = key.replace(/\\s/g, '-');\n\t \n\t      var reference_id = subject_id + '#' + key;\n\t\t\t  \n\t\t\t  // \n\t\t\t  if (1) {\n\t\t\t    // if we use the DOI citatoon linking becomes more\n\t\t\t    // obvious, and we get to talk about the cited references\n\t\t\t    // using their DOIs, but we also gnerate duplicate values for \n\t\t\t    // many metadata items, such as titles and dates, so we need to\n\t\t\t    // handle this. May want to do something such as \n\t\t\t    // store titles as alternateNames to avoid problems.\n\t\t\t    \n          // DOI?\n          if (doc.message[i][j].DOI) {\n \t\t\t\t    // DOI cleaning (sigh)\n\t\t\t\t    /* Sometimes publishes make a mess of this, e.g. \n\t\t\t\t    http://dx.doi.org/10.1111/j.1096-0031.2007.00176.x\n\t\t\t\t    {\n\t\t\t\t\t  key: \"b129_103\",\n\t\t\t\t\t  DOI: \"10.1636/H05-14 SC.1\",\n\t\t\t\t\t  doi-asserted-by: \"publisher\"\n\t\t\t\t    }\n\t\t\t\t   */\n\t\t\t\t    var doi = doc.message[i][j].DOI;\n\t\t\t\t    doi = doi.replace(/sc.1?/g, '');\n\t\t\t\t    doi = doi.replace(/\\s/g, ''); \n\t\t\t\t    doi = doi.toLowerCase(); \n\t\t\t\t    \n\t\t\t\t    reference_id = 'https://doi.org/' + doi;\n         } \n\t\t\t  }\n\n \t\t\t\t// link to work\n\t\t\t\ttriples.push(triple(subject_id,\n\t\t\t\t  'http://schema.org/citation',\n\t\t\t\t  reference_id));\n\t\t\t  \n\t\t\t  // type\n\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t'http://schema.org/CreativeWork'));\n\n\n               // DOI?\n               if (doc.message[i][j].DOI) {\n \t\t\t\t  // DOI cleaning (sigh)\n\t\t\t\t  /* Sometimes publishes make a mess of this, e.g. \n\t\t\t\t  http://dx.doi.org/10.1111/j.1096-0031.2007.00176.x\n\t\t\t\t  {\n\t\t\t\t\tkey: \"b129_103\",\n\t\t\t\t\tDOI: \"10.1636/H05-14 SC.1\",\n\t\t\t\t\tdoi-asserted-by: \"publisher\"\n\t\t\t\t  }\n\t\t\t\t  */\n\t\t\t\t  var doi = doc.message[i][j].DOI;\n\t\t\t\t  doi = doi.replace(/sc.1?/g, '');\n\t\t\t\t  doi = doi.replace(/\\s/g, ''); \n\t\t\t\t  doi = doi.toLowerCase(); \n\t\t\t\t  \n                 var identifier_id = reference_id + '#doi';\n                              \n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/identifier',\n\t\t\t\t\tidentifier_id));\n\t\t\t\t\t\n\t\t\t\t triples.push(triple(identifier_id,\n\t\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t'http://schema.org/PropertyValue'));\n\n\t\t\t\t  triples.push(triple(identifier_id,\n\t\t\t\t\t'http://schema.org/propertyID',\n\t\t\t\t\t'doi'));\n\n\t\t\t\t  triples.push(triple(identifier_id,\n\t\t\t\t\t'http://schema.org/value',\n\t\t\t\t\tdoc.message[i][j].DOI.toLowerCase()\n\t\t\t\t  ));\n\t\t\t\t              \n\t\t\t\t  \n\t\t\t\t\t\n\t\t\t\t \t\t\t  \t\t\t\t\t\t\n\t\t\t\t}  \n\t\t\t\t\n\t\t\t\t// unstructured?\n                if (doc.message[i][j].unstructured) {\n                \tvar text = doc.message[i][j].unstructured;\n                \ttext = text.replace(/\\n/g, '');\n                \t\n                \tif (text.match(/^http/)) {\n                \t  text = '\"' + text + '\"';\n                \t}\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/description',\n\t\t\t\t\ttext\n\t\t\t\t\t));\n\t\t\t\t}               \n\t\t\t\t\t\n\t\t\t\t// metadata\n               if (doc.message[i][j].author) {\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/creator',\n\t\t\t\t\tdoc.message[i][j].author));\n\t\t\t\t}               \n\t\t\t\t\n\t\t\t\t\n               if (doc.message[i][j]['article-title']) {\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\tdoc.message[i][j]['article-title']));\n\t\t\t\t}               \n\t\t\t\t\n\t\t\t\t// container\n                if (doc.message[i][j]['journal-title']) {\n \n                \t// Default container id\n               \t\tvar container_id = reference_id + '-container';\n                 \n \t\t\t\t\t// A better container_id is the ISSN               \n                \n                \t// 1. Do we have ISSN?\n                \tvar reference_issn = '';\n\n                \tif (doc.message[i][j].ISSN) {\n                \t\treference_issn = doc.message[i][j].ISSN;\n                \t\treference_issn = reference_issn.replace('http://id.crossref.org/issn/', '');                \t\t\n                \t}\n                \t\n                \t// 2. To do, can we lookup ISSN?\n                \tif (reference_issn == '') {\n                \t  reference_issn = journal_to_issn(doc.message[i][j]['journal-title']);\n                \t}\n                \t              \t\n                \t// 3. Use ISSN if we have it\t\n               \t\tif (reference_issn != '') {\n               \t\t\tcontainer_id = 'http://worldcat.org/issn/' + reference_issn;\n               \t\t}\n               \t\t\n  \t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/isPartOf',\n\t\t\t\t\tcontainer_id));\n\n \t\t\t\t  triples.push(triple(container_id,\n\t\t\t\t\t'http://schema.org/name',\n\t\t\t\t\tdoc.message[i][j]['journal-title']\n\t\t\t\t\t));\n\t\t\t\t\t\n\t\t\t\t  triples.push(triple(container_id,\n\t\t\t\t\t'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n\t\t\t\t\t'http://schema.org/Periodical'));\n\t\t\t\t\t\n\t\t\t\t} \n               if (doc.message[i][j].volume) {\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/volumeNumber',\n\t\t\t\t\tdoc.message[i][j].volume));\n\t\t\t\t}               \t\t\t\t             \n               if (doc.message[i][j]['first-page']) {\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/pageStart',\n\t\t\t\t\tdoc.message[i][j]['first-page']));\n\t\t\t\t}               \n               if (doc.message[i][j].year) {\n               \t\tvar year = doc.message[i][j].year;\n                \tyear = year.replace(/[a-z]$/, '');\n\t\t\t\t  triples.push(triple(reference_id,\n\t\t\t\t\t'http://schema.org/datePublished',\n\t\t\t\t\tyear));\n\t\t\t\t}               \n\t\t\t\t             \n\t\t\t  }\n\t\t\t\n\t\t\tbreak;\n  \n\t\t\t\n\n        default:\n          break;\n      }\n    }\n\n    if (type == '') {\n      type = 'http://schema.org/CreativeWork';\n    }\n    \n\n    // defaults\n    triples.push(triple(subject_id,\n      'http://www.w3.org/1999/02/22-rdf-syntax-ns#type',\n      type));\n\n    output(doc, triples);\n  }\n}\n\nfunction (doc) {\n  if (doc['message-format']) {\n    if (doc['message-format'] == 'application/vnd.crossref-api-message+json') {\n      if (doc.message.stack) {\n        // CrossRef error\n      } else {\n        message(doc);\n      }\n    }\n  }\n}\n// END COUCHDB VIEW\n"
    },
    "citation": {
      "map": "function (doc) {\n  if (doc['message-format']) {\n    if (doc['message-format'] == 'application/vnd.crossref-api-message+json') {\n\n\t  var csl = doc.message;\n  \n\t  if (csl.DOI) {\n\t\tif (csl.reference) {\n\t\t  for (var i in csl.reference) {\n\t\t\tif (csl.reference[i].DOI) {\n\t\t\t  emit(csl.reference[i].DOI, 1);\n\t\t\t}\n\t\t  }\n\t\t}\n\t  }\n\t}\t\n  }\n}",
      "reduce": "_sum"
    }
  },
  "language": "javascript"
}
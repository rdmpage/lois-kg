<?php

// Delete records from CouchDB to start afresh

require_once (dirname(__FILE__) . '/config.inc.php');
require_once (dirname(__FILE__) . '/couchsimple.php');

// Get list of documents
// http://127.0.0.1:5984/data-lake/_design/housekeeping/_view/ids

$json = '{
    "total_rows": 101,
    "offset": 0,
    "rows": [
        {
            "id": "https://doi.org/10.1111/j.1471-8286.2006.01678.x",
            "key": "2020-01-26T14:43:48+00:00",
            "value": "https://doi.org/10.1111/j.1471-8286.2006.01678.x"
        },
        {
            "id": "10.2476/asjaa.58.103",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.103"
        },
        {
            "id": "10.2476/asjaa.58.59",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.59"
        },
        {
            "id": "10.2476/asjaa.58.65",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.65"
        },
        {
            "id": "10.2476/asjaa.58.67",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.67"
        },
        {
            "id": "10.2476/asjaa.58.69",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.69"
        },
        {
            "id": "10.2476/asjaa.58.87",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.87"
        },
        {
            "id": "10.2476/asjaa.58.91",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.58.91"
        },
        {
            "id": "10.2476/asjaa.59.1",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.1"
        },
        {
            "id": "10.2476/asjaa.59.15",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.15"
        },
        {
            "id": "10.2476/asjaa.59.17",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.17"
        },
        {
            "id": "10.2476/asjaa.59.21",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.21"
        },
        {
            "id": "10.2476/asjaa.59.31",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.31"
        },
        {
            "id": "10.2476/asjaa.59.39",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.39"
        },
        {
            "id": "10.2476/asjaa.59.43",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.43"
        },
        {
            "id": "10.2476/asjaa.59.5",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.5"
        },
        {
            "id": "10.2476/asjaa.59.51",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.51"
        },
        {
            "id": "10.2476/asjaa.59.57",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.57"
        },
        {
            "id": "10.2476/asjaa.59.63",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.59.63"
        },
        {
            "id": "10.2476/asjaa.60.1",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.1"
        },
        {
            "id": "10.2476/asjaa.60.103",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.103"
        },
        {
            "id": "10.2476/asjaa.60.37",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.37"
        },
        {
            "id": "10.2476/asjaa.60.41",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.41"
        },
        {
            "id": "10.2476/asjaa.60.47",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.47"
        },
        {
            "id": "10.2476/asjaa.60.5",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.5"
        },
        {
            "id": "10.2476/asjaa.60.51",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.51"
        },
        {
            "id": "10.2476/asjaa.60.55",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.55"
        },
        {
            "id": "10.2476/asjaa.60.71",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.71"
        },
        {
            "id": "10.2476/asjaa.60.75",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.75"
        },
        {
            "id": "10.2476/asjaa.60.89",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.89"
        },
        {
            "id": "10.2476/asjaa.60.9",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.9"
        },
        {
            "id": "10.2476/asjaa.60.93",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.60.93"
        },
        {
            "id": "10.2476/asjaa.61.1",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.1"
        },
        {
            "id": "10.2476/asjaa.61.11",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.11"
        },
        {
            "id": "10.2476/asjaa.61.27",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.27"
        },
        {
            "id": "10.2476/asjaa.61.5",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.5"
        },
        {
            "id": "10.2476/asjaa.61.77",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.77"
        },
        {
            "id": "10.2476/asjaa.61.93",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.61.93"
        },
        {
            "id": "10.2476/asjaa.65.7",
            "key": "2020-02-02T13:36:45+00:00",
            "value": "10.2476/asjaa.65.7"
        },
        {
            "id": "10.2476/asjaa.1.10",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.1.10"
        },
        {
            "id": "10.2476/asjaa.1.114",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.1.114"
        },
        {
            "id": "10.2476/asjaa.1.14",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.1.14"
        },
        {
            "id": "10.2476/asjaa.17.13",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.17.13"
        },
        {
            "id": "10.2476/asjaa.17.25",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.17.25"
        },
        {
            "id": "10.2476/asjaa.17.3",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.17.3"
        },
        {
            "id": "10.2476/asjaa.17.33",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.17.33"
        },
        {
            "id": "10.2476/asjaa.17.9",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.17.9"
        },
        {
            "id": "10.2476/asjaa.18.1",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.18.1"
        },
        {
            "id": "10.2476/asjaa.18.21",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.18.21"
        },
        {
            "id": "10.2476/asjaa.18.7",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.18.7"
        },
        {
            "id": "10.2476/asjaa.19.21",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.19.21"
        },
        {
            "id": "10.2476/asjaa.19.28",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.19.28"
        },
        {
            "id": "10.2476/asjaa.19.5",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.19.5"
        },
        {
            "id": "10.2476/asjaa.2.115",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.2.115"
        },
        {
            "id": "10.2476/asjaa.2.162",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.2.162"
        },
        {
            "id": "10.2476/asjaa.20.21",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.20.21"
        },
        {
            "id": "10.2476/asjaa.20.46",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.20.46"
        },
        {
            "id": "10.2476/asjaa.20.50",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.20.50"
        },
        {
            "id": "10.2476/asjaa.21.31",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.21.31"
        },
        {
            "id": "10.2476/asjaa.21.35",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.21.35"
        },
        {
            "id": "10.2476/asjaa.21.40",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.21.40"
        },
        {
            "id": "10.2476/asjaa.22.14",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.22.14"
        },
        {
            "id": "10.2476/asjaa.22.17",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.22.17"
        },
        {
            "id": "10.2476/asjaa.23.1",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.23.1"
        },
        {
            "id": "10.2476/asjaa.23.13",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.23.13"
        },
        {
            "id": "10.2476/asjaa.23.26",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.23.26"
        },
        {
            "id": "10.2476/asjaa.41.103",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.41.103"
        },
        {
            "id": "10.2476/asjaa.41.119",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.41.119"
        },
        {
            "id": "10.2476/asjaa.41.133",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.41.133"
        },
        {
            "id": "10.2476/asjaa.41.153",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.41.153"
        },
        {
            "id": "10.2476/asjaa.61.19",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.61.19"
        },
        {
            "id": "10.2476/asjaa.61.55",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.61.55"
        },
        {
            "id": "10.2476/asjaa.61.7",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.61.7"
        },
        {
            "id": "10.2476/asjaa.62.1",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.1"
        },
        {
            "id": "10.2476/asjaa.62.103",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.103"
        },
        {
            "id": "10.2476/asjaa.62.109",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.109"
        },
        {
            "id": "10.2476/asjaa.62.19",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.19"
        },
        {
            "id": "10.2476/asjaa.62.29",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.29"
        },
        {
            "id": "10.2476/asjaa.62.33",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.33"
        },
        {
            "id": "10.2476/asjaa.62.51",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.51"
        },
        {
            "id": "10.2476/asjaa.62.55",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.55"
        },
        {
            "id": "10.2476/asjaa.62.7",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.7"
        },
        {
            "id": "10.2476/asjaa.62.75",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.75"
        },
        {
            "id": "10.2476/asjaa.62.81",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.81"
        },
        {
            "id": "10.2476/asjaa.62.89",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.89"
        },
        {
            "id": "10.2476/asjaa.62.95",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.62.95"
        },
        {
            "id": "10.2476/asjaa.63.",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63."
        },
        {
            "id": "10.2476/asjaa.63.1",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.1"
        },
        {
            "id": "10.2476/asjaa.63.23",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.23"
        },
        {
            "id": "10.2476/asjaa.63.27",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.27"
        },
        {
            "id": "10.2476/asjaa.63.31",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.31"
        },
        {
            "id": "10.2476/asjaa.63.37",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.37"
        },
        {
            "id": "10.2476/asjaa.63.65",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.65"
        },
        {
            "id": "10.2476/asjaa.63.73",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.73"
        },
        {
            "id": "10.2476/asjaa.63.79",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.79"
        },
        {
            "id": "10.2476/asjaa.63.83",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.83"
        },
        {
            "id": "10.2476/asjaa.63.87",
            "key": "2020-02-02T13:36:46+00:00",
            "value": "10.2476/asjaa.63.87"
        },
        {
            "id": "10.2476/asjaa.41.11",
            "key": "2020-02-02T13:36:47+00:00",
            "value": "10.2476/asjaa.41.11"
        },
        {
            "id": "10.2476/asjaa.41.161",
            "key": "2020-02-02T13:36:47+00:00",
            "value": "10.2476/asjaa.41.161"
        },
        {
            "id": "10.2476/asjaa.41.187",
            "key": "2020-02-02T13:36:47+00:00",
            "value": "10.2476/asjaa.41.187"
        },
        {
            "id": "10.2476/asjaa.41.199",
            "key": "2020-02-02T13:36:47+00:00",
            "value": "10.2476/asjaa.41.199"
        }
    ]
}';

$obj = json_decode($json);

foreach ($obj->rows as $row)
{
	//echo $row->value . "\n";		
	$couch->add_update_or_delete_document(null, $row->value, 'delete');
}

?>